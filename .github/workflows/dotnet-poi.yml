name: API - .NET POI CI

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]
    paths:
      - '/apis/poi/**'

jobs:
  build:

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2
    - name: Setup .NET Core
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: 3.1.101
    - name: Install dependencies
      working-directory: apis/poi
      run: dotnet restore
    - name: Build
      working-directory: apis/poi
      run: dotnet build --configuration Release --no-restore
    - name: Test
      working-directory: apis/poi/tests/UnitTests
      run: dotnet test --no-restore --verbosity normal
    - name: failure-check
      uses: monacorp/action-name@master
    - name: throw an error
      run: | 
          throw 'something failed';
    - name: My backup step
      if: ${{ failure() }}
      uses: actions/heroku@master 
      with:
        script: |
          github.issues.create({
            owner: context.repo.owner,
            repo: context.repo.repo,
            title: 'failure failure..',
            assignees: [ '${{ github.actor }}' ],
            body: 'failure happened'
            })  
      
